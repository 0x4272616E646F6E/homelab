apiVersion: v1
kind: ConfigMap
metadata:
  name: nvidia-device-plugin-config-map
  namespace: kube-system
data:
  values.yaml: |-
    config:
      map:
        default: |-
          version: v1
          flags:
            migStrategy: none
          sharing:
            timeSlicing:
              renameByDefault: false
              failRequestsGreaterThanOne: false
              resources:
                - name: nvidia.com/gpu
                  replicas: 8
      default: "default"
      fallbackStrategies: ["named","single"]

    image:
      repository: nvcr.io/nvidia/k8s-device-plugin
      pullPolicy: IfNotPresent
      tag: ""  # set exact tag, e.g. v0.17.3

    updateStrategy:
      type: RollingUpdate

    tolerations:
      - key: nvidia.com/gpu
        operator: Exists
        effect: NoSchedule

    priorityClassName: system-node-critical

    devicePlugin:
      enabled: true

    gfd:
      enabled: false
    nfd:
      enableNodeFeatureApi: false

    resources: {}