apiVersion: v1
kind: ConfigMap
metadata:
  name: clickstack-config-map
  namespace: monitoring
data:
  values.yaml: |-
    global:
      storageClassName: local-path-rwo
    hyperdx:
      appUrl: "https://hyperdx.hosted.fail"
      frontendUrl: "https://hyperdx.hosted.fail"
      resources:
        requests:
          cpu: 150m
          memory: 256Mi
        limits:
          cpu: 500m
          memory: 512Mi
      tolerations:
        - key: node-role.kubernetes.io/control-plane
          operator: Exists
          effect: NoSchedule
        - key: node-role.kubernetes.io/master
          operator: Exists
          effect: NoSchedule
    clickhouse:
      persistence:
        dataSize: 50Gi
        logSize: 5Gi
      resources:
        requests:
          cpu: 500m
          memory: 1Gi
        limits:
          cpu: 2000m
          memory: 4Gi
      tolerations:
        - key: node-role.kubernetes.io/control-plane
          operator: Exists
          effect: NoSchedule
        - key: node-role.kubernetes.io/master
          operator: Exists
          effect: NoSchedule
    mongodb:
      persistence:
        dataSize: 10Gi
      tolerations:
        - key: node-role.kubernetes.io/control-plane
          operator: Exists
          effect: NoSchedule
        - key: node-role.kubernetes.io/master
          operator: Exists
          effect: NoSchedule
    otel:
      customConfig: |
        receivers:
          syslog:
            tcp:
              listen_address: "0.0.0.0:514"
            udp:
              listen_address: "0.0.0.0:514"
            protocol: rfc3164
            location: UTC
        service:
          pipelines:
            logs/syslog:
              receivers: [syslog]
              processors: [memory_limiter, batch]
              exporters: [clickhouse]
      resources:
        requests:
          cpu: 100m
          memory: 128Mi
        limits:
          cpu: 500m
          memory: 512Mi
      tolerations:
        - key: node-role.kubernetes.io/control-plane
          operator: Exists
          effect: NoSchedule
        - key: node-role.kubernetes.io/master
          operator: Exists
          effect: NoSchedule
