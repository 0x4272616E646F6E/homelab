apiVersion: v1
kind: ConfigMap
metadata:
  name: knative-config-map
  namespace: knative
data:
  values.yaml: |-
    knative_operator:
      knative_operator:
        image: gcr.io/knative-releases/knative.dev/operator/cmd/operator@sha256:dfa69033a2778bb4052e61c20047e746a74a7aab2f58424e085985aaf85c1906
        tag: {{ tag }}
        affinity: {}
        tolerations: []
        containerSecurityContext:
          allowPrivilegeEscalation: false
          readOnlyRootFilesystem: true
          runAsNonRoot: true
        resources:
          requests:
            cpu: 100m
            memory: 100Mi
          limits:
            cpu: 1000m
            memory: 1000Mi
      operator_webhook:
        image: gcr.io/knative-releases/knative.dev/operator/cmd/webhook@sha256:9201cfb8d2b86b798916d7c87d3c766d150c3975ba245e581afe7d8b246de2e7
        tag: {{ tag }}
        affinity:
          # To avoid node becoming SPOF, spread our replicas to different nodes.
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
              - podAffinityTerm:
                  labelSelector:
                    matchLabels:
                      app: operator-webhook
                  topologyKey: kubernetes.io/hostname
                weight: 100
        tolerations: []
        containerSecurityContext:
          allowPrivilegeEscalation: false
          readOnlyRootFilesystem: true
          runAsNonRoot: true
        resources:
          requests:
            cpu: 100m
            memory: 100Mi
          limits:
            cpu: 500m
            memory: 500Mi
      kubernetes_min_version: v1.25.0