apiVersion: cilium.io/v2
kind: CiliumEgressGatewayPolicy
metadata:
  name: media-egress
  labels:
    app.kubernetes.io/managed-by: flux
    app.kubernetes.io/name: media
spec:
  selectors:
    - podSelector:
        matchExpressions:
          - {key: app.kubernetes.io/name, operator: In, values: [flaresolverr, qbittorrent, sabnzbd, rtorrent, nzbget]}
          - {key: io.kubernetes.pod.namespace, operator: In, values: [media]}
  destinationCIDRs:
    - 0.0.0.0/0
  egressGateway:
    nodeSelector:
      matchLabels:
        kubernetes.io/hostname: "talos-4m3-8nj"
    interface: wg0
