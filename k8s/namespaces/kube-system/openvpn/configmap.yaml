apiVersion: v1
kind: ConfigMap
metadata:
  name: openvpn-config-map
  namespace: kube-system
  labels:
    app.kubernetes.io/managed-by: flux
    app.kubernetes.io/name: openvpn
data:
  client.conf: |
    client
    dev tun
    proto udp
    remote VPN.SERVER.ADDR 1194
    resolv-retry infinite
    nobind
    persist-key
    persist-tun
    remote-cert-tls server
    verb 3
    cipher AES-256-CBC
    auth SHA256
    # these will reference files in /etc/openvpn/ (mounted from Secret)
    ca /etc/openvpn/ca.crt
    cert /etc/openvpn/client.crt
    key /etc/openvpn/client.key
    # optional tls-auth if your server uses it
    # tls-auth /etc/openvpn/ta.key 1
    script-security 2
    up /etc/openvpn/on-up.sh
    down /etc/openvpn/on-down.sh
    # do not redirect-gateway to avoid replacing host default route
    # route-nopull