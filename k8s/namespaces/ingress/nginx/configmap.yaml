apiVersion: v1
kind: ConfigMap
metadata:
  name: nginx-gateway-fabric-config-map
  namespace: ingress
data:
  values.yaml: |-
    clusterDomain: cluster.local

    nginxGateway:
      kind: deployment
      name: ""
      gatewayClassName: nginx
      podAnnotations: {}
      labels: {}
      gatewayClassAnnotations: {}
      gatewayControllerName: gateway.nginx.org/nginx-gateway-controller
      replicas: 2
      image:
        repository: ghcr.io/nginx/nginx-gateway-fabric
        tag: 2.4.0
        pullPolicy: IfNotPresent
      productTelemetry:
        enable: false
      tolerations: []
      autoscaling:
        enable: false
      metrics:
        enable: true
        port: 9113
        secure: false
      gwAPIExperimentalFeatures:
        enable: false
      gwAPIInferenceExtension:
        enable: false
        endpointPicker:
          disableTLS: false
          skipVerify: true
      snippetsFilters:
        enable: true

    nginx:
      kind: deployment
      replicas: 2
      patches: []
      autoscaling:
        enable: false
      image:
        repository: ghcr.io/nginx/nginx-gateway-fabric/nginx
        tag: 2.4.0
        pullPolicy: IfNotPresent
      config:
        entries:
          # Performance tuning
          worker-processes: "auto"
          worker-connections: "10240"
          keepalive-requests: "1000"
          keepalive-timeout: "75s"
          # Buffer sizes
          client-body-buffer-size: "16k"
          client-header-buffer-size: "1k"
          large-client-header-buffers: "4 8k"
          # Timeouts
          client-body-timeout: "60s"
          client-header-timeout: "60s"
          send-timeout: "60s"
          # Proxy settings
          proxy-connect-timeout: "60s"
          proxy-send-timeout: "60s"
          proxy-read-timeout: "60s"
          proxy-buffering: "on"
          proxy-buffer-size: "4k"
          proxy-buffers: "8 4k"
          proxy-busy-buffers-size: "8k"
          proxy-next-upstream: "error timeout invalid_header http_500 http_502 http_503"
          proxy-next-upstream-timeout: "0s"
          proxy-next-upstream-tries: "3"
          # Upstream keepalive
          upstream-keepalive-connections: "32"
          upstream-keepalive-requests: "100"
          upstream-keepalive-timeout: "60s"
          # Upstream health
          fail-timeout: "10s"
          max-fails: "3"
          # Rate limiting & connections
          limit-req-status-code: "429"
          limit-conn-status-code: "429"
          # Security headers
          server-tokens: "off"
          hide-headers: "X-Powered-By,Server"
          add-headers: "ingress/nginx-security-headers"
          # Logging
          error-log-level: "warn"
          access-log-off: "false"
          log-format-escape-json: "true"
          # Compression
          gzip-level: "5"
          gzip-types: "application/atom+xml application/javascript application/json application/rss+xml application/vnd.ms-fontobject application/x-font-ttf application/x-web-app-manifest+json application/xhtml+xml application/xml font/opentype image/svg+xml image/x-icon text/css text/plain text/x-component text/xml text/javascript"
          # Security
          ssl-protocols: "TLSv1.2 TLSv1.3"
          ssl-ciphers: "ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305"
          ssl-prefer-server-ciphers: "on"
          ssl-session-cache: "shared:SSL:10m"
          ssl-session-timeout: "10m"
          ssl-session-tickets: "off"
          # HTTP/2
          http2-max-concurrent-streams: "128"
          http2-max-field-size: "4k"
          http2-max-header-size: "16k"
          # Hash sizes (for many routes/variables)
          variables-hash-bucket-size: "256"
          variables-hash-max-size: "2048"
          # Real IP
          use-forwarded-headers: "true"
          compute-full-forwarded-for: "true"
          forwarded-for-header: "X-Forwarded-For"
      plus: false
      nginxOneConsole:
        dataplaneKeySecretName: ""
        endpointHost: ""
        endpointPort: 443
        skipVerify: false
      productTelemetry:
        enable: false
      imagePullSecret: ""
      imagePullSecrets: []
      usage:
        secretName: ""
        endpoint: ""
        resolver: ""
        skipVerify: false
        caSecretName: ""
        clientSSLSecretName: ""
        enforceInitialReport: false
      service:
        type: LoadBalancer
        externalTrafficPolicy: Local
        loadBalancerIP: "10.0.0.248"
        loadBalancerClass: ""
        loadBalancerSourceRanges: []
    certGenerator:
      enable: true
